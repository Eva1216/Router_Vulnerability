# D-Link DIR-842 XSS and Unauthorized access vulnerability

#### Vendorï¼šD-LINK
#### Product: DIR-842
#### Firmware version: v1.05
#### Hardware version: A1
#### Download link: ftp://ftp2.dlink.com/PRODUCTS/DIR-842/REVA/DIR-842_REVA_FIRMWARE_v1.05B02.zip


## Vulnerability detail


### XSS in Home.html

Login in admin Home page, set the ssid and password to config your router.

![](http://static.zybuluo.com/H4l0/yws501jljp566iw39dg8dk8n/image.png)

Insert xss payload in ssid area.

![](http://static.zybuluo.com/H4l0/yws501jljp566iw39dg8dk8n/image.png)

When the information preserved, xss tiggered in next page. 

![](http://static.zybuluo.com/H4l0/yws501jljp566iw39dg8dk8n/image.png)

### XSS in WebsiteFilter.html

In this page, router allow user add some filtering rules into text area. There exist a XSS vulnerability.

![](http://static.zybuluo.com/H4l0/u3598ml6oa3qx91qm7ecmpeo/image.png)

When you insert a xss payload, like `11"/onmousemove="alert(1)"`, the xss tiggered.

![](http://static.zybuluo.com/H4l0/utetilu35mnaxp0kne09v36s/image.png)

### Bypass Authentication

The vuln allow attacker download configure file with no authentication.

In System.html page, you can download the config file to store in location, but there no verify cookie and allow attacker get it easily.

![](http://static.zybuluo.com/H4l0/5hud2z8ncro3uywehm0d846w/image.png)

Like this.

![](http://static.zybuluo.com/H4l0/yws501jljp566iw39dg8dk8n/image.png)
